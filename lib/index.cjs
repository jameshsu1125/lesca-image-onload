"use strict";var c=(s=>(s[s.unload=0]="unload",s[s.loading=1]="loading",s[s.loaded=2]="loaded",s))(c||{});const y={hideBeforeLoaded:!0,onUpdate:s=>{}};class k{index;result;constructor(){this.index=0,this.result=[]}load(e,n=y){if(!e)return new Promise(t=>{t({total:0,loaded:0})});const g={...y,...n},{onUpdate:u,hideBeforeLoaded:f}=g,h=this.getStyle(e,"display")==="flex"?"flex":"block";f&&(e.style.display="none");var w=Array.from(e.querySelectorAll("*"));[e,...w].forEach((t,o)=>{const l=t.tagName,a=t.getAttribute("src"),r=this.getStyle(t,"background-image").replace(/url\((['"])?(.*?)\1\)/gi,"$2"),d=this.getStyle(t,"-webkit-mask-image").replace(/url\((['"])?(.*?)\1\)/gi,"$2"),i=c.unload;return l==="IMG"&&a?(this.result.push({url:a,index:o,status:i}),!0):l==="DIV"&&r!=="none"?(r.includes("gradient")||this.result.push({url:r,index:o,status:i}),!0):(l==="DIV"&&d!=="none"&&this.result.push({url:d,index:o,status:i}),!1)});const p=({resolve:t=l=>console.log(l),reject:o=l=>console.log(l)})=>{if(this.result.length===0){f&&(e.style.display=h),t({total:0,loaded:0});return}const l=this.result[this.index],a=this.result.length,{url:r,index:d}=l;l.status=c.loading;const i=new Image;i.onload=()=>{l.status=c.loaded;const m=this.result.filter(I=>I.status===c.loaded).length;a===m?(f&&(e.style.display=h),requestAnimationFrame(()=>t({url:r,total:a,loaded:m,index:d}))):(u({url:r,total:a,loaded:m,index:d}),this.index++,p({resolve:t,reject:o}))},i.src=r};return new Promise((t,o)=>{p({resolve:t,reject:o})})}getStyle(e,n){let g;const u=e.ownerDocument.defaultView;return u&&u.getComputedStyle?(n=n.replace(/([A-Z])/g,"-$1").toLowerCase(),u.getComputedStyle(e,null).getPropertyValue(n)):e.currentStyle?(n=n.replace(/\-(\w)/g,function(f,h){return h.toUpperCase()}),g=e.currentStyle[n],g):""}}module.exports=k;
